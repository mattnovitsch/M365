DeviceNetworkEvents 
| where RemotePort == 80 or RemotePort == 443
| where RemoteUrl <> ""
| where InitiatingProcessAccountName !contains "service" and InitiatingProcessAccountName <> "system" and InitiatingProcessAccountName  <> ""
| join kind=leftouter (DeviceEvents
| where ActionType == 'SmartScreenUrlWarning'
| extend A=parse_json(AdditionalFields)
) on DeviceName, RemoteUrl
| where InitiatingProcessFileName == "msedge.exe" or InitiatingProcessFileName == "chrome.exe"
//| where RemoteUrl contains "facebook"
//| where InitiatingProcessAccountName contains "Matt"
| project Timestamp,DeviceName, Action=ActionType1, URL_IPAddress=RemoteIP, URL=RemoteUrl, Username=InitiatingProcessAccountName, Browser=InitiatingProcessFileName 